--- postgresql-16.2/src/backend/main/main.c	2024-02-05 22:41:37.000000000 +0100
+++ postgresql-16.2-wasm/src/backend/main/main.c	2024-04-26 11:41:08.554066992 +0200
@@ -41,7 +41,6 @@
 #include "utils/pg_locale.h"
 #include "utils/ps_status.h"
 
-
 const char *progname;
 static bool reached_main = false;
 
@@ -51,10 +50,12 @@
 static void help(const char *progname);
 static void check_root(const char *progname);
 
-
 /*
  * Any Postgres server process begins execution here.
  */
+#if defined(__EMSCRIPTEN__) || defined(__wasi__)
+#include PG_MAIN_INCLUDE
+#else
 int
 main(int argc, char *argv[])
 {
@@ -199,6 +200,7 @@
 	/* the functions above should not return */
 	abort();
 }
+#endif /* wasm */
 
 
 
